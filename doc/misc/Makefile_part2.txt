
OBJ		=	$(addprefix $(OBJDIR)/, $(SRC:.c=.o))
DEP		=	$(OBJ:.o=.d)
DEPFILE	=	$(OBJDIR)/$(DIRSRC)/.build

.SILENT:

all		:	$(OBJDIR) $(NAME)

-include $(DEP)

$(addprefix $(OBJDIR)/, %.d)	:	%.c
	$(CC) $(CFLAGS) $< -MM -MT $(@:.d=.o) 2> /dev/null > $@

$(addprefix $(OBJDIR)/, %.o)	:	%.c
	$(CC) $(CFLAGS) -o $@ -c $<
	echo -e '\033[0;32mBuilding C Object $@\033[0m'

$(NAME)	:	$(OBJ) $(DEPFILE)
	ar rcs $(NAME) $(OBJ)
	echo -e '\033[1;31mC libraries \033[1;35m$(NAME) \033[1;33m$(CC)\033[0m'

$(DEPFILE)	:
	touch $@
	echo -e '\033[1;35mBuilding dependencies \033[0m'
	make 2> /dev/null > /dev/null

clean	:
		/bin/rm	-fr $(OBJDIR)
		echo -e '\033[1;34mClean libraries $(NAME)\033[0m'

fclean	:	clean
		/bin/rm -fr $(NAME)
		echo -e '\033[1;34mFclean libraries $(NAME)\033[0m'

re		:	fclean
		make

debug	:	CFLAGS += $(DEBUG)
debug	:	fclean all
		echo -e '\033[1;31mDebug version \033[1;35m$(DEBUG)\033[0m'

analyze	:
		clang --analyze -Xanalyzer -analyzer-output=html $(SRC) -I./include

every	:	CFLAGS += -Weverything -Wno-gnu-zero-variadic-macro-arguments
every	:	fclean all
		echo -e '\033[1;33mGood job !\033[0m'

$(OBJDIR)	:
		/bin/mkdir $(OBJDIR);			\
		for DIR in $(LISTDIR);			\
		do								\
			/bin/mkdir $(OBJDIR)/$$DIR;	\
		done							\

help	:
		echo -e '\033[1;34mclean\t\033[0m⇒ Cleaning all object'
		echo -e '\033[1;34mfclean\t\033[0m⇒ Cleaning all object and libraries'
		echo -e '\033[1;34mdebug\t\033[0m⇒ Add debug flags'
		echo -e '\033[1;34mre\t\033[0m⇒ Deleting all object and build'
		echo -e ""
		echo -e '\033[1;34mevery\t\033[0m⇒ God code'

.PHONY:	clean fclean re debug every
